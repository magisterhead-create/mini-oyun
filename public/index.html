<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/style.css" />
  </head>

  <body>
    <div class="container">
      <div class="content">
        <h1>BaÅŸ Dedektif & Polis</h1>
        <div class="game-subtitle">ONLINE CO-OP DEDÃœKTÄ°F OYUNU</div>

        <!-- 1) ANA MENÃœ -->
        <div class="section main-menu" id="menuSection">
          <h2 class="screen-title">Ana MenÃ¼</h2>
          <p class="screen-subtitle">
            Bir oda kurup arkadaÅŸÄ±nÄ± davet et veya oda koduyla bir oyuna katÄ±l.
          </p>

          <div class="menu-buttons">
            <button id="hostBtn" class="btn-primary btn-large">
              ODA OLUÅTUR
            </button>
            <button id="joinMenuBtn" class="btn-secondary btn-large">
              ODAYA KATIL
            </button>
          </div>

          <button id="settingsBtn" class="btn-ghost btn-small settings-btn" style="margin-top:14px;">
            âš™ï¸ Settings
          </button>

          <div id="settingsPanel" class="sub-panel" style="display:none;">
            <div style="margin-bottom:4px; font-weight:500; color:#e5e7eb;">Oyun AyarlarÄ± (placeholder)</div>
            <p>Åimdilik sadece gÃ¶rsel. Ä°leride ses seviyesi, dil, tema gibi ayarlarÄ± buraya ekleyebiliriz.</p>
          </div>

          <div class="footer-bar">
            <div class="footer-bar-left">
              <button id="howToBtn" class="btn-link">How to Play</button>
              <button id="creditsBtn" class="btn-link">Credits</button>
            </div>
            <div class="footer-bar-right">v0.1 Â· prototip build</div>
          </div>
        </div>

        <!-- 2) BAÄLANTI EKRANI -->
        <div class="section" id="connectionSection" style="display:none;">
          <h2 class="screen-title">BaÄŸlan</h2>
          <p class="screen-subtitle">Ä°smini yaz, sonra odaya baÄŸlan. RolÃ¼nÃ¼ lobide seÃ§eceksin.</p>

          <div class="label">Ä°smin</div>
          <input id="nameInput" placeholder="Takma adÄ±n (Ã¶rn: DedektifAyÅŸe)" />

          <!-- Join modu iÃ§in oda kodu -->
          <div id="roomCodeGroup" style="margin-top:12px; display:none;">
            <div class="label">Oda Kodu</div>
            <input id="roomCodeInput" placeholder="Ã–rn: ABCD1" />
          </div>

          <!-- Host modu iÃ§in ekstra alanlar (oda ismi + ÅŸifre) -->
          <div id="hostExtraGroup" style="margin-top:12px; display:none;">
            <div class="label">Oda Ä°smi (isteÄŸe baÄŸlÄ±)</div>
            <input id="roomNameInput" placeholder="Ã–rn: AkÅŸam VardiyasÄ± VakasÄ±" />

            <div class="label" style="margin-top:8px;">Oda Åifresi (isteÄŸe baÄŸlÄ±)</div>
            <input id="roomPasswordInput" placeholder="BoÅŸ bÄ±rakÄ±rsan ÅŸifresiz olur" />
          </div>

          <div style="display:flex; gap:8px; margin-top:14px; flex-wrap:wrap;">
            <button id="connectBtn" class="btn-primary" style="flex:1;">Devam et</button>
            <button id="backToMenuFromConnectBtn" class="btn-secondary" style="flex:1;">Ana menÃ¼ye dÃ¶n</button>
          </div>

          <div id="joinError" class="message error" style="display:none;"></div>

          <!-- Community Server List -->
          <div id="roomListPanel" class="sub-panel" style="margin-top:16px; display:none;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
              <div style="font-size:12px; text-transform:uppercase; letter-spacing:0.12em; color:var(--text-muted);">
                AÃ§Ä±k Odalar
              </div>
              <div style="display:flex; align-items:center; gap:8px;">
                <div style="font-size:11px; color:var(--text-muted);">
                  Ping: <span id="pingLabel">-</span>
                </div>
                <button id="refreshRoomsBtn" class="btn-ghost btn-small">Yenile</button>
              </div>
            </div>
            <div id="roomListContainer" style="font-size:13px;">
              Åu anda aÃ§Ä±k oda yok.
            </div>
          </div>
        </div>

        <!-- 3) LOBBY & OYUN -->
        <div class="lobby-layout">

          <!-- LOBBY -->
          <div class="section" id="lobbySection" style="display:none;">
            <h2 class="screen-title">Lobby</h2>
            <p class="screen-subtitle">RolÃ¼nÃ¼ seÃ§, hazÄ±r ol ve host oyunu baÅŸlatsÄ±n.</p>

            <!-- Room Code + Invite -->
            <div class="lobby-top-strip">
              <div class="lobby-top-row">
                <div>
                  <div class="room-code-label">Room code</div>
                  <div id="roomCodeDisplay" class="room-code-text">â€” â€” â€” â€” â€”</div>
                </div>
                <div class="lobby-top-actions">
                  <button id="copyLinkBtn" class="btn-secondary btn-chip">Kopyala</button>
                  <button id="inviteFriendBtn" class="btn-primary btn-chip">Invite friend</button>
                </div>
              </div>
            </div>

            <!-- Players -->
            <div class="players-box-wrapper">
              <div class="players-box-title">Players in room</div>
              <div class="players-box">
                <div id="playersList"></div>
              </div>
            </div>

            <!-- Setup -->
            <div class="lobby-setup">
              <div class="lobby-setup-title">Setup</div>

              <div class="setup-grid">
                <div>
                  <div class="label">Aktif rolÃ¼n</div>
                  <div id="myRoleInfo" style="font-size:13px; margin-top:4px;"></div>
                  <button id="openRoleSelectBtn" class="btn-secondary btn-small" style="margin-top:8px;">
                    Rol SeÃ§
                  </button>
                  <div id="roleError" class="message error" style="display:none;"></div>
                </div>

                <div>
                  <div class="label">Vaka seÃ§</div>
                  <button id="selectCaseBtn" class="btn-ghost btn-small" style="margin-top:6px;">
                    Default Case
                  </button>
                  <div class="setup-note">
                    Åimdilik tek vaka var. Ä°leride farklÄ± hikÃ¢yeler buradan seÃ§ilecek.
                  </div>
                </div>
              </div>
            </div>

            <!-- Actions -->
            <div class="lobby-actions">
              <button id="lobbyReadyBtn" class="btn-primary">HazÄ±rÄ±m</button>
              <button id="startGameBtn" class="btn-secondary" style="display:none;">Oyunu BaÅŸlat</button>
              <button id="backToMenuBtn" class="btn-ghost">Ana menÃ¼ye dÃ¶n</button>
            </div>

            <div id="lobbyMessage" class="message info-soft" style="display:none; margin-top:10px;"></div>
          </div>

          <!-- PHASES / FINAL / RESULT -->
          <div>

            <!-- Phase -->
            <div class="section" id="phaseSection" style="display:none;">
              <h2 id="phaseTitle">BÃ¶lÃ¼m</h2>
              <div id="phaseContent" class="phase-box"></div>
              <button id="phaseReadyBtn" class="btn-primary" style="margin-top:10px;">
                HazÄ±rÄ±m (Sonraki AÅŸama)
              </button>
              <div id="phaseInfo" class="message info-soft" style="display:none;"></div>
            </div>

            <!-- Final Answer -->
            <div class="section" id="finalSection" style="display:none;">
              <h2>Son AÅŸama: Ã‡Ã¶zÃ¼m</h2>
              <div id="finalQuestion" style="margin-bottom:6px;"></div>
              <input id="answerInput" placeholder="CevabÄ±nÄ±z (Ã¶r: garson)" />
              <button id="submitAnswerBtn" class="btn-primary" style="margin-top:10px;">
                CevabÄ± GÃ¶nder
              </button>
              <div id="finalInfo" class="message info-soft" style="display:none;"></div>
            </div>

            <!-- Result -->
            <div class="section" id="resultSection" style="display:none;">
              <h2>SonuÃ§</h2>
              <div id="resultText"></div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- OVERLAYS -->
    <div id="overlayBackdrop" class="overlay-backdrop" style="display:none;">

      <!-- How To -->
      <div class="overlay-card" id="howToOverlay" style="display:none;">
        <h3>How to Play</h3>
        <p>1. Bir oyuncu oda oluÅŸturur ve kodu arkadaÅŸÄ±na gÃ¶nderir.</p>
        <p>2. DiÄŸer oyuncu â€œOdaya KatÄ±lâ€ deyip kodu yazar.</p>
        <p>3. Lobide rol seÃ§ilir ve herkes â€œHazÄ±rÄ±mâ€ der.</p>
        <p>4. Host "Oyunu BaÅŸlat" deyince ipuÃ§larÄ± aÃ§Ä±lÄ±r.</p>
        <p>5. Finalde katili tahmin edin!</p>
        <div class="overlay-footer">
          <button id="overlayCloseBtn1" class="btn-secondary btn-small">Kapat</button>
        </div>
      </div>

      <!-- Credits -->
      <div class="overlay-card" id="creditsOverlay" style="display:none;">
        <h3>Credits</h3>
        <p>Oyun tasarÄ±mÄ± ve geliÅŸtirme:</p>
        <p>ğŸ‘¤ Sen + Yapay Zeka AsistanÄ±n</p>
        <p>Teknolojiler: Node.js, Express, Socket.IO, Render</p>
        <div class="overlay-footer">
          <button id="overlayCloseBtn2" class="btn-secondary btn-small">Kapat</button>
        </div>
      </div>

      <!-- Role Select -->
      <div class="overlay-card" id="roleSelectOverlay" style="display:none;">
        <h3>Rol SeÃ§</h3>
        <p>Karakterini seÃ§:</p>

        <div class="role-grid">
          <div class="role-card" data-role="dedektif">
            <div class="role-avatar role-avatar-dedektif"></div>
            <div class="role-name">BaÅŸ Dedektif</div>
            <div class="role-desc">Ä°puÃ§larÄ±nÄ± birleÅŸtiren zihin.</div>
          </div>

          <div class="role-card" data-role="polis">
            <div class="role-avatar role-avatar-polis"></div>
            <div class="role-name">Polis</div>
            <div class="role-desc">Sahadaki gÃ¶z, kulak ve refleks.</div>
          </div>
        </div>

        <div class="overlay-footer">
          <button id="roleOverlayCloseBtn" class="btn-secondary btn-small">Ä°ptal</button>
        </div>
      </div>

      <!-- Case Select -->
      <div class="overlay-card" id="caseSelectOverlay" style="display:none;">
        <h3>Vaka SeÃ§</h3>
        <p>Bir dosya seÃ§ ve soruÅŸturmayÄ± baÅŸlat:</p>

        <div class="case-grid">
          <!-- Åimdilik tek vaka kartÄ± -->
          <div class="case-card" data-case-id="restaurant_murder">
            <div class="case-header">
              <div class="case-victim-photo"></div>
              <div>
                <div class="case-title">Restorandaki Cinayet</div>
                <div class="case-meta">
                  Kurban: Mert YÄ±lmaz<br/>
                  Olay Yeri: NiÅŸantaÅŸÄ±'nda lÃ¼ks bir restoran<br/>
                  Saat: 22:30 civarÄ±
                </div>
              </div>
            </div>

            <div class="case-brief">
              BaÅŸarÄ±lÄ± bir iÅŸ insanÄ± akÅŸam yemeÄŸi sÄ±rasÄ±nda restoran masasÄ±nda Ã¶lÃ¼ bulunur.
              Garson, iÅŸ ortaÄŸÄ± ve eski sevgili baÅŸ ÅŸÃ¼pheliler arasÄ±nda.
            </div>

            <div class="case-suspects">
              <div><strong>ÅÃ¼pheliler:</strong></div>
              <ul>
                <li>Restoran Garsonu</li>
                <li>Ä°ÅŸ OrtaÄŸÄ±</li>
                <li>Eski Sevgili</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="overlay-footer" style="justify-content: space-between;">
          <button id="caseOverlayCloseBtn" class="btn-secondary btn-small">Ä°ptal</button>
          <button id="beginInvestigationBtn" class="btn-primary btn-small">
            Begin Investigation
          </button>
        </div>
      </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/client.js"></script>
  </body>
</html>
