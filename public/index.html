<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <title>BaÅŸ Dedektif & Polis</title>
    <link rel="stylesheet" href="/style.css" />
  </head>

  <body>
    <div class="container">
      <div class="content">
        <h1>BaÅŸ Dedektif & Polis</h1>
        <div class="game-subtitle">ONLINE CO-OP DEDÃœKTÄ°F OYUNU</div>

        <!-- 1) ANA MENÃœ -->
        <div class="section main-menu" id="menuSection">
          <h2 class="screen-title">Ana MenÃ¼</h2>
          <p class="screen-subtitle">
            Bir oda kurup arkadaÅŸÄ±nÄ± davet et veya oda koduyla bir oyuna katÄ±l.
          </p>

          <div class="menu-buttons">
            <button id="hostBtn" class="btn-primary btn-large">
              ODA OLUÅTUR
            </button>
            <button id="joinMenuBtn" class="btn-secondary btn-large">
              ODAYA KATIL
            </button>
          </div>

          <button
            id="settingsBtn"
            class="btn-ghost btn-small settings-btn"
            style="margin-top:14px;"
          >
            âš™ï¸ Settings
          </button>

          <div id="settingsPanel" class="sub-panel" style="display:none;">
            <div
              style="margin-bottom:4px; font-weight:500; color:#e5e7eb;"
            >
              Oyun AyarlarÄ± (placeholder)
            </div>
            <p>
              Åimdilik sadece gÃ¶rsel. Ä°leride ses seviyesi, dil, tema gibi
              ayarlarÄ± buraya ekleyebiliriz.
            </p>
          </div>

          <div class="footer-bar">
            <div class="footer-bar-left">
              <button id="howToBtn" class="btn-link">How to Play</button>
              <button id="creditsBtn" class="btn-link">Credits</button>
            </div>
            <div class="footer-bar-right">v0.1 Â· prototip build</div>
          </div>
        </div>

        <!-- 2) BAÄLANTI EKRANI -->
        <div class="section" id="connectionSection" style="display:none;">
          <h2 class="screen-title">BaÄŸlan</h2>
          <p class="screen-subtitle">
            Ä°smini yaz, sonra odaya baÄŸlan. RolÃ¼nÃ¼ lobide seÃ§eceksin.
          </p>

          <div class="label">Ä°smin</div>
          <input
            id="nameInput"
            placeholder="Takma adÄ±n (Ã¶rn: DedektifAyÅŸe)"
          />

          <!-- HOST iken gÃ¶rÃ¼nen ekstra alanlar -->
          <div id="hostExtraGroup" style="margin-top:12px; display:none;">
            <div class="label">Oda AdÄ± (isteÄŸe baÄŸlÄ±)</div>
            <input
              id="roomNameInput"
              placeholder="Ã–rn: AkÅŸam SeansÄ±, ArkadaÅŸlarla Oda"
            />

            <div class="label" style="margin-top:10px;">
              Oda Åifresi (isteÄŸe baÄŸlÄ±)
            </div>
            <input
              id="roomPasswordInput"
              placeholder="Åifre koymak istemiyorsan boÅŸ bÄ±rak"
            />
          </div>

          <div id="roomCodeGroup" style="margin-top:12px; display:none;">
            <div class="label">Oda Kodu</div>
            <input id="roomCodeInput" placeholder="Ã–rn: ABCD1" />
          </div>

          <!-- BaÄŸlan + Oda listesi -->
          <div class="connection-layout">
            <div class="connection-main">
              <div
                style="
                  display:flex;
                  gap:8px;
                  margin-top:14px;
                  flex-wrap:wrap;
                "
              >
                <button
                  id="connectBtn"
                  class="btn-primary"
                  style="flex:1;"
                >
                  Devam et
                </button>
                <button
                  id="backToMenuFromConnectBtn"
                  class="btn-secondary"
                  style="flex:1;"
                >
                  Ana menÃ¼ye dÃ¶n
                </button>
              </div>

              <div
                id="joinError"
                class="message error"
                style="display:none;"
              ></div>
            </div>

            <!-- Oda listesi paneli (join modunda aÃ§Ä±lÄ±yor) -->
            <div
              id="roomListPanel"
              class="room-list-panel"
              style="display:none;"
            >
              <div class="room-list-header">
                <div class="room-list-title">AÃ§Ä±k Odalar</div>
                <div class="room-list-actions">
                  <button
                    id="refreshRoomsBtn"
                    class="btn-ghost btn-small"
                  >
                    Yenile
                  </button>
                  <span class="room-list-ping-label">
                    Ping: <span id="pingLabel">-</span>
                  </span>
                </div>
              </div>
              <div
                id="roomListContainer"
                class="room-list-container"
              >
                Åu anda aÃ§Ä±k oda yok.
              </div>
            </div>
          </div>
        </div>

                <!-- 3) LOBBY & OYUN -->
        <div class="lobby-layout" id="lobbyLayout" style="display:none;">
          <!-- LOBBY -->
          <div class="section" id="lobbySection" style="display:none;">
            <h2 class="screen-title">Lobby</h2>
            <p class="screen-subtitle">
              RolÃ¼nÃ¼ seÃ§, hazÄ±r ol ve host oyunu baÅŸlatsÄ±n.
            </p>

            <!-- Room Code + Invite -->
            <div class="lobby-top-strip">
              <div class="lobby-top-row">
                <div>
                  <div class="room-code-label">Room code</div>
                  <div
                    id="roomCodeDisplay"
                    class="room-code-text"
                  >
                    â€” â€” â€” â€” â€” 
                  </div>
                </div>
                <div class="lobby-top-actions">
                  <button
                    id="copyLinkBtn"
                    class="btn-secondary btn-chip"
                  >
                    Kopyala
                  </button>
                  <button
                    id="inviteFriendBtn"
                    class="btn-primary btn-chip"
                  >
                    Invite friend
                  </button>
                </div>
              </div>
            </div>

            <!-- Players -->
            <div class="players-box-wrapper">
              <div class="players-box-title">
                Players in room
              </div>
              <div class="players-box">
                <div id="playersList"></div>
              </div>
            </div>

            <!-- Setup -->
            <div class="lobby-setup">
              <div class="lobby-setup-title">Setup</div>

              <div class="setup-grid">
                <!-- 1. BLOK: Vaka seÃ§ -->
                <div>
                  <div class="label">Vaka seÃ§</div>
                  <button
                    id="selectCaseBtn"
                    class="btn-ghost btn-small"
                    style="margin-top:6px;"
                  >
                    Case seÃ§iniz
                  </button>
                  <div class="setup-note">
                    Ã–nce bir vaka seÃ§, sonra rolÃ¼nÃ¼ belirle.
                  </div>
                </div>

                <!-- 2. BLOK: Aktif rolÃ¼n -->
                <div>
                  <div class="label">Aktif rolÃ¼n</div>
                  <div id="myRoleInfo" style="font-size:13px; margin-top:4px;"></div>
                  <button
                    id="openRoleSelectBtn"
                    class="btn-secondary btn-small"
                    style="margin-top:8px;"
                    disabled
                  >
                    Rol SeÃ§
                  </button>
                  <div
                    id="roleError"
                    class="message error"
                    style="display:none;"
                  ></div>
                </div>
              </div>
            </div>

            <!-- Actions -->
            <div class="lobby-actions">
              <button id="lobbyReadyBtn" class="btn-primary">
                HazÄ±rÄ±m
              </button>
              <button
                id="startGameBtn"
                class="btn-secondary"
                style="display:none;"
              >
                Oyunu BaÅŸlat
              </button>
              <button id="backToMenuBtn" class="btn-ghost">
                Ana menÃ¼ye dÃ¶n
              </button>
            </div>

            <div
              id="lobbyMessage"
              class="message info-soft"
              style="display:none; margin-top:10px;"
            ></div>
          </div>

          <!-- SAÄ SÃœTUN: OYUN + CHAT -->
          <div class="right-column">

            <!-- YENÄ° OYUN EKRANI (GAME UI) -->
            <div class="section" id="gameSection" style="display:none;">
              <div class="game-top-bar" style="display:flex; justify-content:space-between; align-items:center; gap:8px;">
                <div style="display:flex; flex-direction:column; gap:2px;">
                  <div id="gameTimerDisplay">30:00</div>
                  <div id="gameRoleLabel" style="font-size:12px; color:var(--text-muted);"></div>
                </div>

                <button
                  id="backToMenuFromGameBtn"
                  class="btn-ghost btn-small"
                >
                  Ana menÃ¼ye dÃ¶n
                </button>
              </div>

              <!-- Orta Alan â€” Sekme Ä°Ã§erikleri -->
              <div id="gameTabContent" class="game-content-box">
                LÃ¼tfen bir sekme seÃ§in.
              </div>

              <!-- Alt Sekme MenÃ¼sÃ¼ -->
              <div class="game-tabs">
                <button
                  class="game-tab-btn active"
                  id="tabRoleMainBtn"
                  data-tab="roleMain"
                >
                  Rol
                </button>
                <button
                  class="game-tab-btn"
                  id="tabRoleSpecialBtn"
                  data-tab="roleSpecial"
                >
                  GÃ¶rev
                </button>
                <button
                  class="game-tab-btn"
                  id="tabSharedBoardBtn"
                  data-tab="sharedBoard"
                >
                  Ortak Tahta
                </button>
                <button
  class="game-tab-btn"
  id="tabFieldBtn"
  data-tab="field"
>
  Saha Analizi
</button>

                <button
                  class="game-tab-btn"
                  id="tabNotesBtn"
                  data-tab="notes"
                >
                  Notlar
                </button>
                <button
                  class="game-tab-btn"
                  id="tabSettingsBtn"
                  data-tab="settings"
                >
                  Ayarlar
                </button>
              </div>
            </div>

            <!-- LOBBY CHAT + OYUNCU LÄ°STESÄ° + SES -->
            <div class="section lobby-chat">
              <div class="lobby-chat-header">Lobby Chat</div>

              <div class="players-box-title" style="margin-bottom:4px;">
                Odadaki oyuncular
              </div>
              <div id="gamePlayersList" class="players-box" style="margin-bottom:8px;">
                HenÃ¼z kimse yok.
              </div>

              <div id="chatMessages" class="chat-messages"></div>

              <div class="chat-input-row">
                <input id="chatInput" placeholder="Mesaj yaz..." />
                <button id="chatSendBtn" class="btn-primary btn-small">
                  GÃ¶nder
                </button>
              </div>

              <div class="voice-controls">
                <span class="voice-label">
                  Sesli sohbet:
                </span>
                <div class="voice-buttons">
                  <button id="joinVoiceBtn" class="btn-secondary btn-small">
                    ğŸ™ï¸ Voice'a KatÄ±l
                  </button>
                  <button
                    id="muteToggleBtn"
                    class="btn-ghost btn-small"
                    style="display:none;"
                  >
                    ğŸ”‡ Mute
                  </button>
                  <button
                    id="leaveVoiceBtn"
                    class="btn-ghost btn-small"
                    style="display:none;"
                  >
                    ğŸ“´ Sesten AyrÄ±l
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>


    <!-- OVERLAYS -->
    <div
      id="overlayBackdrop"
      class="overlay-backdrop"
      style="display:none;"
    >
      <!-- How To -->
      <div
        class="overlay-card"
        id="howToOverlay"
        style="display:none;"
      >
        <h3>How to Play</h3>
        <p>1. Bir oyuncu oda oluÅŸturur ve kodu arkadaÅŸÄ±na gÃ¶nderir.</p>
        <p>2. DiÄŸer oyuncu â€œOdaya KatÄ±lâ€ deyip kodu yazar.</p>
        <p>3. Lobide rol seÃ§ilir ve herkes â€œHazÄ±rÄ±mâ€ der.</p>
        <p>4. Host "Oyunu BaÅŸlat" deyince ipuÃ§larÄ± aÃ§Ä±lÄ±r.</p>
        <p>5. Finalde katili tahmin edin!</p>
        <div class="overlay-footer">
          <button
            id="overlayCloseBtn1"
            class="btn-secondary btn-small"
          >
            Kapat
          </button>
        </div>
      </div>

      <!-- Credits -->
      <div
        class="overlay-card"
        id="creditsOverlay"
        style="display:none;"
      >
        <h3>Credits</h3>
        <p>Oyun tasarÄ±mÄ± ve geliÅŸtirme:</p>
        <p>ğŸ‘¤ Sen + Yapay Zeka AsistanÄ±n</p>
        <p>Teknolojiler: Node.js, Express, Socket.IO, Render</p>
        <div class="overlay-footer">
          <button
            id="overlayCloseBtn2"
            class="btn-secondary btn-small"
          >
            Kapat
          </button>
        </div>
      </div>

      <!-- Role Select -->
      <div
        class="overlay-card"
        id="roleSelectOverlay"
        style="display:none;"
      >
        <h3>Rol SeÃ§</h3>
        <p>Karakterini seÃ§:</p>

        <div class="role-grid">
          <div class="role-card" data-role="dedektif">
            <div class="role-avatar role-avatar-dedektif"></div>
            <div class="role-name">BaÅŸ Dedektif</div>
            <div class="role-desc">
              Ä°puÃ§larÄ±nÄ± birleÅŸtiren zihin.
            </div>
          </div>

          <div class="role-card" data-role="polis">
            <div class="role-avatar role-avatar-polis"></div>
            <div class="role-name">Polis</div>
            <div class="role-desc">
              Sahadaki gÃ¶z, kulak ve refleks.
            </div>
          </div>
          <div class="role-card" data-role="kodkÄ±rÄ±cÄ±">
  <div class="role-avatar role-avatar-kodkirici"></div>
  <div class="role-name">Kod KÄ±rÄ±cÄ±</div>
  <div class="role-desc">
    Dijital izleri ve gizli verileri ortaya Ã§Ä±karan teknik zeka.
  </div>
</div>
          <div class="role-card" data-role="sahaanalizcisi">
  <div class="role-avatar" style="background:linear-gradient(135deg,#78350f,#f59e0b);"></div>
  <div class="role-name">Saha Analizcisi</div>
  <div class="role-desc">Haritadan saha verisi toplar, halkla konuÅŸur.</div>
</div>

        </div>

        <div class="overlay-footer">
          <button
            id="roleOverlayCloseBtn"
            class="btn-secondary btn-small"
          >
            Ä°ptal
          </button>
        </div>
      </div>

      <!-- Case Select -->
      <div
        class="overlay-card"
        id="caseSelectOverlay"
        style="display:none;"
      >
        <h3>Vaka SeÃ§</h3>
        <p>Oynamak istediÄŸiniz vakayÄ± seÃ§in:</p>

        <div class="case-grid">
          <div
            class="case-card"
            data-case-id="restaurant_murder"
          >
            <div class="case-title">Restoran Cinayeti</div>
            <div class="case-brief">
              Åehrin popÃ¼ler bir restoranÄ±nda iÅŸlenen esrarengiz bir cinayet.
              Kurban, Ã¼nlÃ¼ bir iÅŸ insanÄ±. ÅÃ¼pheliler arasÄ±nda garson, ÅŸef ve
              ortaÄŸÄ± var.
            </div>
            <div class="case-meta">
              Zorluk: Orta Â· SÃ¼re: 15â€“20 dk
            </div>
          </div>
           <div class="case-card" data-case-id="bank_heist">
    <div class="case-title">Banka Soygunu</div>
    <div class="case-brief">
      Åehrin merkezindeki bÃ¼yÃ¼k bir bankada gizemli bir soygun gerÃ§ekleÅŸti.
      GÃ¼venlik sisteminin iÃ§eriden sabote edildiÄŸi dÃ¼ÅŸÃ¼nÃ¼lÃ¼yor.
    </div>
    <div class="case-meta">
      Zorluk: Orta Â· SÃ¼re: 20â€“25 dk
    </div>
  </div>
        </div>

        <div class="overlay-footer">
          <button
            id="caseOverlayCloseBtn"
            class="btn-secondary btn-small"
          >
            Ä°ptal
          </button>
          <button
            id="beginInvestigationBtn"
            class="btn-primary btn-small"
          >
            Begin Investigation
          </button>
        </div>
      </div>
    </div>
<!-- === SAHA ANALÄ°ZCÄ°SÄ° â€” NPC KONUÅMA MODALÄ° === -->
<div id="fieldTalkModal" class="interrogation-modal" style="display:none;">
  
  <div class="interrogation-window">

    <div class="interrogation-header">
      <div class="interrogation-title">Mahalle Sakini ile KonuÅŸ</div>
      <button id="fieldTalkCloseBtn" class="close-btn">Ã—</button>
    </div>

    <div id="fieldTalkMessages" class="interrogation-messages"></div>

    <form id="fieldTalkForm" class="interrogation-input-row">
      <input
        id="fieldTalkInput"
        placeholder="Bir ÅŸey sor..."
        autocomplete="off"
      />
      <button class="btn-primary" type="submit">GÃ¶nder</button>
    </form>

  </div>

</div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/client.js"></script>
        
  </body>
</html>
